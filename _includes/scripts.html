<script>
document.addEventListener("DOMContentLoaded", function() {
  console.log("PaperCache script loaded and DOM is ready.");

  // Smooth scroll for sidebar links
  var sidebarLinks = document.querySelectorAll('.sidebar-nav a');
  console.log("Found " + sidebarLinks.length + " sidebar links.");
  
  for (var i = 0; i < sidebarLinks.length; i++) {
    sidebarLinks[i].addEventListener("click", function(e) {
      e.preventDefault();
      var targetId = this.getAttribute('href').substring(1);
      var targetElement = document.getElementById(targetId);
      
      if (targetElement) {
        targetElement.scrollIntoView({
          behavior: 'smooth',
          block: 'start'
        });
      }
    });
  }
  
  // Initialize sidebar on page load
  setTimeout(function() {
    console.log("Sidebar initialized - all categories expanded");
  }, 100);

  // Smooth scroll for sidebar links
  var sidebarLinks = document.querySelectorAll('.sidebar-nav a[href^="#"]');
  console.log("Found " + sidebarLinks.length + " sidebar anchor links.");

  sidebarLinks.forEach(anchor => {
    anchor.addEventListener('click', function (e) {
      e.preventDefault();
      const targetId = this.getAttribute('href');
      console.log("Sidebar link clicked, target:", targetId);
      
      const targetElement = document.querySelector(targetId);

      if (targetElement) {
        console.log("Found target element:", targetElement);
        const headerOffset = 80; // Adjust this value to your header's height
        const elementPosition = targetElement.getBoundingClientRect().top;
        const offsetPosition = elementPosition + window.pageYOffset - headerOffset;

        window.scrollTo({
          top: offsetPosition,
          behavior: "smooth"
        });
      } else {
        console.error("Target element not found for selector:", targetId);
      }
    });
  });
});

// Load tag interaction script
document.addEventListener('DOMContentLoaded', function() {
  if (document.querySelector('.subcategory-tag')) {
    console.log('Loading tag interaction script...');
    const tagScript = document.createElement('script');
    tagScript.src = '{{ site.baseurl }}/assets/js/tag-interactions.js';
    document.head.appendChild(tagScript);
  } else {
    console.log('No tag elements found, skipping tag interaction script');
  }
});
</script>